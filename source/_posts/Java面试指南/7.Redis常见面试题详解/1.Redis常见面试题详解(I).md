---
title: 1.Redis常见面试题&详解(I)
date: 2024-02-26 16:10:59
tags:
---
# Redis常见面试题&详解

## 你们项目中的Redis一般运用在什么场景中？有什么作用？

## Redis为什么这么快？

1. **内存存储：** Redis是将数据存储在内存当中的，而内存的IO速度比磁盘的IO速度快上几个数量级，因此Redis很快，同时基于内存也导致其存储空间有限。内存访问一次大概120ns（微秒），SSD 硬盘访问一次50-150us（纳秒），如果按照访问一次150us来算，性能差距在1000倍。这是因为1us等于1000ns。所以，150微秒是150,000纳秒，而120纳秒只是150微秒的一千分之一。

2. **数据结构：** Redis提供了多种数据结构，5种基础数据结构String、List、Hash、Set、ZSet，3中特殊结构HyperLogLog (布隆过滤器)、Geospatial (地理空间索引)、Bitmaps (位图)，这些数据结构都是Redis专门优化过的，支持高效的读写操作。

3. **非阻塞式IO：** Redis 基于 IO 多路复用实现了非阻塞式 IO，采用 IO 多路复用技术，并发处理连接。通过 epoll 模型和自己实现的简单的事件框架，将 epoll 中的读、写、关闭、连接都转化成了事件，然后利用 epoll 的多路复用特性，把 IO 操作时间优化到了极致。

4. **单线程模型：** Redis 把所有主线操作使用单线程模型，将网络 IO 以及指令读写全部交由一个线程来执行。 这样可以带来避免线程创建而导致的性能消耗，多线程上下文切换而引起的 CPU 开销，以及避免了多个线程之间的竞争问题，比如临界区资源的线程安全、锁的申请、释放以及死锁等问题。

## Redis有哪些数据结构？其实现原理是怎样的？

1. **字符串（String）**：字符串是最基本的数据结构，在 Redis 中以键值对的形式存储。字符串类型的值可以包含任何类型的数据，比如整数、浮点数、甚至是二进制数据。Redis 的字符串实现基于 **简单动态字符串（SDS）** 替换了传统字符串，内部有一个 len 字段记录了字符串长度：实现了 O(1) 复杂度的 strlen 操作，并保证了二进制安全性。以及 Redis 在内部针对区分了多种 SDS 类型，不同大小的字符串会对应不同的 SDS 实现，有效的节省内存。

2. **哈希表（Hash）**：哈希表在 Redis 中以键值对的形式存储，其中每个键都对应一个字段和一个值的映射。哈希表适用于存储对象类型的数据，比如用户信息、产品信息等。Redis 的哈希表实现采用了类似于 Java 的 HashMap 的数据结构，可以实现快速的查找、插入和删除操作。

3. **列表（List）**：列表是一种有序的数据结构，在 Redis 中以插入顺序存储。列表允许重复的值，并且支持在列表的两端进行插入、删除和查找操作，因此可以用于实现队列、栈等数据结构。Redis 的列表实现基于双向链表和压缩列表（当列表长度较短时）的数据结构，具有高效的插入、删除和索引操作。

4. **集合（Set）**：集合是一种无序且不重复的数据结构，在 Redis 中用于存储唯一的值。集合支持基本的集合运算，如交集、并集、差集等，并且可以快速地判断一个值是否存在于集合中。Redis 的集合实现基于哈希表，可以实现高效的插入、删除和查找操作。

5. **有序集合（Sorted Set）**：有序集合是集合的一种扩展，它在每个成员值上关联了一个分数（score），并且按照分数对成员进行排序。有序集合适用于需要按照特定顺序访问成员的场景，比如排行榜、优先级队列等。Redis 的有序集合实现基于跳跃表（Skip List）和哈希表，可以实现快速的插入、删除和按照分数范围进行查找的操作。

6. **位图（Bitmap）**：位图是一种特殊的数据结构，它以比特（bit）的形式存储数据。在 Redis 中，位图可以用于记录用户的在线状态、统计用户行为、进行布隆过滤器等。Redis 的位图实现使用字节数组来存储位，并提供了一系列位操作命令，如设置位、清除位、计数位等。

7. **HyperLogLog (布隆过滤器)：** 
HyperLogLog 是用于估计基数（集合中不同元素的数量）的算法。它能以极小的内存消耗来估计集合的基数，适合于对大规模数据进行近似统计分析，例如统计网站的独立访客数或唯一 IP 数等。在 Redis 中，您可以使用 HyperLogLog 数据结构来执行类似的操作。

8. **Geospatial (地理空间索引)：** 
Redis 的地理空间支持使得您可以将地理位置信息与键值存储在一起，并可以基于空间坐标执行范围查询。这允许您在 Redis 中构建地理信息系统（GIS）应用程序，例如位置服务、附近的商家搜索等。


## Redis宕机数据会丢失吗？

如果Redis没有开启任何的持久化机制，那么数据就会全部丢失，否则只会丢失部分数据，丢失数据的多少取决于采用的持久化配置。

Redis提供了两套持久化机制，RDB和AOF：

RDB会根据设置的情况定期去fork一个子进程，生成当前时间节点数据库的全量快照。如果在RDB快照完成之后出现宕机，那么会丢失掉快照生成期间的全部增量数据，如果在快照还没生成成功的时候宕机，则会丢失掉所有的数据。

AOF则会将每次执行的Redis命令追加到日志文件当中，然后恢复的时候根据日志文件中的指令记录来进行数据的恢复。